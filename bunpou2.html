<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ—¥æ–‡å–®å­—å°æ¸¬é©—</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #f5f5f5;
    }
    .container {
      margin-top: 80px;
      background-color: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
      width: 90%;
      max-width: 400px;
    }
    h1 {
      text-align: center;
    }
    .question {
      font-size: 20px;
      margin-bottom: 10px;
    }
    .input-container {
      margin-bottom: 20px;
    }
    input[type="text"] {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      border: 2px solid #ddd;
      border-radius: 5px;
    }
    button {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:disabled {
      background-color: #ddd;
    }
    .feedback {
      text-align: center;
      font-size: 18px;
    }
    .next-button {
      background-color: #008CBA;
    }
    .progress-wrapper {
      width: 100%;
      position: fixed;
      top: 0;
      left: 0;
      padding: 10px 20px;
      background-color: #ffffff;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      z-index: 1000;
      box-sizing: border-box;
    }
    .progress-container {
      width: 100%;
      background-color: #ddd;
      border-radius: 5px;
      overflow: hidden;
      height: 10px;
      margin-bottom: 5px;
    }
    .progress-bar {
      height: 100%;
      background-color: #4CAF50;
      width: 0%;
      transition: width 0.3s ease;
    }
    #progressText {
      text-align: right;
      font-size: 12px;
      margin: 0;
      color: #555;
    }
  </style>
</head>
<body>
  <div class="progress-wrapper">
    <div class="progress-container">
      <div class="progress-bar" id="progressBar"></div>
    </div>
    <p id="progressText">0 / 0</p>
  </div>

  <div class="container">
    <h1>æ—¥æ–‡å–®å­—å°æ¸¬é©—</h1>
    <div class="question-container">
      <p class="question">æº–å‚™å¥½äº†å—ï¼Ÿé–‹å§‹ï¼</p>
      <div class="input-container">
        <input type="text" id="answer" placeholder="è«‹è¼¸å…¥å¹³å‡å">
      </div>
      <button id="submit" disabled>é€å‡º</button>
      <div class="feedback"></div>
    </div>
  </div>

  <script>
    const rawWordBank = {
        "å°‘å­é«˜é½¢åŒ–": { hiragana: ["ã—ã‚‡ã†ã—ã“ã†ã‚Œã„ã‹"], chinese: "å°‘å­é«˜é½¡åŒ–" },
        "ç¾çŠ¶": { hiragana: ["ã’ã‚“ã˜ã‚‡ã†"], chinese: "ç¾ç‹€" },
        "å›½éš›é€£åˆ": { hiragana: ["ã“ãã•ã„ã‚Œã‚“ã”ã†"], chinese: "åœ‹éš›è¯åˆï¼ˆè¯åˆåœ‹ï¼‰" },
        "ç·äººå£": { hiragana: ["ãã†ã˜ã‚“ã“ã†"], chinese: "ç¸½äººå£" },
        "ç”£ã‚€": { hiragana: ["ã†ã‚€"], chinese: "ç”Ÿï¼ˆå­©å­ï¼‰" },
        "å‡ºç”Ÿ": { hiragana: ["ã—ã‚…ã£ã—ã‚‡ã†", "ã—ã‚…ã£ã›ã„"], chinese: "å‡ºç”Ÿ" },
        "ä¸‹å›ã‚‹": { hiragana: ["ã—ãŸã¾ã‚ã‚‹"], chinese: "ä½æ–¼" },
        "æ€¥é€Ÿ": { hiragana: ["ãã‚…ã†ãã"], chinese: "æ€¥é€Ÿ" },
        "åŒ»å­¦": { hiragana: ["ã„ãŒã"], chinese: "é†«å­¸" },
        "æ™©å©š": { hiragana: ["ã°ã‚“ã“ã‚“"], chinese: "æ™šå©š" },
        "æœªå©š": { hiragana: ["ã¿ã“ã‚“"], chinese: "æœªå©š" },
        "æ­¯æ­¢ã‚": { hiragana: ["ã¯ã©ã‚"], chinese: "æŠ‘åˆ¶ã€åˆ¶æ­¢" },
        "ç”Ÿç”£åŠ›": { hiragana: ["ã›ã„ã•ã‚“ã‚Šã‚‡ã"], chinese: "ç”Ÿç”¢åŠ›" },
        "ç¤¾ä¼šä¿éšœ": { hiragana: ["ã—ã‚ƒã‹ã„ã»ã—ã‚‡ã†"], chinese: "ç¤¾æœƒä¿éšœ" },
        "è² æ‹…": { hiragana: ["ãµãŸã‚“"], chinese: "è² æ“”" },
        "åˆ¶åº¦": { hiragana: ["ã›ã„ã©"], chinese: "åˆ¶åº¦" },
        "è‡ªä¸»æ€§": { hiragana: ["ã˜ã—ã‚…ã›ã„"], chinese: "è‡ªä¸»æ€§" },
        "å¹´é‡‘": { hiragana: ["ã­ã‚“ãã‚“"], chinese: "å¹´é‡‘" },
        "è²¡æ”¿": { hiragana: ["ã–ã„ã›ã„"], chinese: "è²¡æ”¿" },
        "è²¯è“„": { hiragana: ["ã¡ã‚‡ã¡ã"], chinese: "å„²è“„" },
        "åˆ‡ã‚Šå´©ã™": { hiragana: ["ãã‚Šããšã™"], chinese: "å‹•ç”¨ï¼ˆå„²è“„ï¼‰" },
        "å¤§å¤šæ•°": { hiragana: ["ã ã„ãŸã™ã†"], chinese: "å¤§å¤šæ•¸" },
        "æ¶ˆè²»": { hiragana: ["ã—ã‚‡ã†ã²"], chinese: "æ¶ˆè²»" },
        "è³‡æœ¬": { hiragana: ["ã—ã»ã‚“"], chinese: "è³‡æœ¬" },
        "æ´»ç™ºåŒ–": { hiragana: ["ã‹ã£ã±ã¤ã‹"], chinese: "æ´»åŒ–" },
        "åŸå‹•åŠ›": { hiragana: ["ã’ã‚“ã©ã†ã‚Šã‚‡ã"], chinese: "åŸå‹•åŠ›" },
        "å®Ÿæ–½": { hiragana: ["ã˜ã£ã—"], chinese: "å¯¦æ–½" },
        "è²¡æº": { hiragana: ["ã–ã„ã’ã‚“"], chinese: "è²¡æº" },
        "ä»‹è­·ä¿é™ºæ³•": { hiragana: ["ã‹ã„ã”ã»ã‘ã‚“ã»ã†"], chinese: "ç…§è­·ä¿éšªæ³•" },
        "å†é…åˆ†": { hiragana: ["ã•ã„ã¯ã„ã¶ã‚“"], chinese: "å†åˆ†é…" },
        "é£Ÿã„æ­¢ã‚ã‚‹": { hiragana: ["ãã„ã¨ã‚ã‚‹"], chinese: "é˜²æ­¢ã€é˜»æ­¢" },
        "è‡ªæ²»ä½“": { hiragana: ["ã˜ã¡ãŸã„"], chinese: "åœ°æ–¹æ”¿åºœ" },
        "è‚²å…": { hiragana: ["ã„ãã˜"], chinese: "è‚²å…’" },
        "æ•´å‚™": { hiragana: ["ã›ã„ã³"], chinese: "æ•´å‚™ã€å»ºè¨­" },
        "æä¾›": { hiragana: ["ã¦ã„ãã‚‡ã†"], chinese: "æä¾›" },
        "é€²å‡º": { hiragana: ["ã—ã‚“ã—ã‚…ã¤"], chinese: "é€²å‡º" },
        "å¦¨ã’": { hiragana: ["ã•ã¾ãŸã’"], chinese: "é˜»ç¤™" },
        "ä¸€å‘ã«": { hiragana: ["ã„ã£ã“ã†ã«"], chinese: "å®Œå…¨ï¼ˆä¸ï¼‰" },
        "æ°—é…": { hiragana: ["ã‘ã¯ã„"], chinese: "è·¡è±¡" },
        "æ§‹ç¯‰": { hiragana: ["ã“ã†ã¡ã"], chinese: "æ§‹ç¯‰" },
        "ç§»æ°‘": { hiragana: ["ã„ã¿ã‚“"], chinese: "ç§»æ°‘" },
        "å¼•ãå—ã‘ã‚‹": { hiragana: ["ã²ãã†ã‘ã‚‹"], chinese: "æ‰¿æ“”" },
        "æŸ”è»Ÿ": { hiragana: ["ã˜ã‚…ã†ãªã‚“"], chinese: "æŸ”è»Ÿ" },
        "å§¿å‹¢": { hiragana: ["ã—ã›ã„"], chinese: "æ…‹åº¦" },
        "ç¨åå…¥": { hiragana: ["ãœã„ã—ã‚…ã†ã«ã‚…ã†"], chinese: "ç¨…æ”¶" },
        "ç¦ç¥‰": { hiragana: ["ãµãã—"], chinese: "ç¦åˆ©" },
        "é€²è¡Œ": { hiragana: ["ã—ã‚“ã“ã†"], chinese: "é€²è¡Œ" },
        "ç©æ¥µçš„": { hiragana: ["ã›ã£ãã‚‡ãã¦ã"], chinese: "ç©æ¥µçš„" },
        "ä¸¡ç«‹": { hiragana: ["ã‚Šã‚‡ã†ã‚Šã¤"], chinese: "å…¼é¡§" },
        "å¹¼å…": { hiragana: ["ã‚ˆã†ã˜"], chinese: "å¹¼å…’" },
        "å…ç«¥": { hiragana: ["ã˜ã©ã†"], chinese: "å…’ç«¥" },
        "æœªæˆå¹´": { hiragana: ["ã¿ã›ã„ã­ã‚“"], chinese: "æœªæˆå¹´" },
        "å°‘å¹´çŠ¯ç½ª": { hiragana: ["ã—ã‚‡ã†ã­ã‚“ã¯ã‚“ã–ã„"], chinese: "å°‘å¹´çŠ¯ç½ª" },
        "è‹¥è€…æ–‡åŒ–": { hiragana: ["ã‚ã‹ã‚‚ã®ã¶ã‚“ã‹"], chinese: "å¹´è¼•äººæ–‡åŒ–" },
        "æˆäºº": { hiragana: ["ã›ã„ã˜ã‚“"], chinese: "æˆäºº" },
        "é’å¹´": { hiragana: ["ã›ã„ã­ã‚“"], chinese: "é’å¹´" },
        "ä¸­é«˜å¹´": { hiragana: ["ã¡ã‚…ã†ã“ã†ã­ã‚“"], chinese: "ä¸­è€å¹´" },
        "ç†Ÿå¹´é›¢å©š": { hiragana: ["ã˜ã‚…ãã­ã‚“ã‚Šã“ã‚“"], chinese: "ç†Ÿé½¡é›¢å©š" },
        "è‚²å…ä¼‘æš‡": { hiragana: ["ã„ãã˜ãã‚…ã†ã‹"], chinese: "è‚²å¬°å‡" },
        "æ ¸å®¶æ—": { hiragana: ["ã‹ãã‹ãã"], chinese: "å°å®¶åº­" },
        "è€çœ¼": { hiragana: ["ã‚ã†ãŒã‚“"], chinese: "è€èŠ±çœ¼" },
        "ç™½é«ª": { hiragana: ["ã—ã‚‰ãŒ"], chinese: "ç™½é«®" },
        "ä¸Šç´š": { hiragana: ["ã˜ã‚‡ã†ãã‚…ã†"], chinese: "é«˜ç´š" },
        "é€šä¿¡æ•™è‚²": { hiragana: ["ã¤ã†ã—ã‚“ãã‚‡ã†ã„ã"], chinese: "å‡½æˆæ•™è‚²" },
        "å¹…åºƒã„": { hiragana: ["ã¯ã°ã²ã‚ã„"], chinese: "å»£æ³›" },
        "æµæš¢": { hiragana: ["ã‚Šã‚…ã†ã¡ã‚‡ã†"], chinese: "æµæš¢" },
        "å¾“æ¥": { hiragana: ["ã˜ã‚…ã†ã‚‰ã„"], chinese: "ä»¥å¾€" },
        "æˆè‚²": { hiragana: ["ã›ã„ã„ã"], chinese: "æˆé•·èˆ‡åŸ¹è‚²" },
        "å¢—å¤§": { hiragana: ["ãã†ã ã„"], chinese: "å¢åŠ " },
        "ä¸–ä»£": { hiragana: ["ã›ã ã„"], chinese: "ä¸–ä»£" },
        "è£œåŠ©ç·š": { hiragana: ["ã»ã˜ã‚‡ã›ã‚“"], chinese: "è¼”åŠ©ç·š" },
        "å°å…¥": { hiragana: ["ã©ã†ã«ã‚…ã†"], chinese: "å°å…¥" },
        "åŠ´åŠ›": { hiragana: ["ã‚ã†ã‚Šã‚‡ã"], chinese: "äººåŠ›" },
        "é›‡ç”¨": { hiragana: ["ã“ã‚ˆã†"], chinese: "é›‡ç”¨" },
        "å±æ©Ÿçš„": { hiragana: ["ããã¦ã"], chinese: "å±æ©Ÿçš„" },
        "æ‚²è¦³": { hiragana: ["ã²ã‹ã‚“"], chinese: "æ‚²è§€" },
        "é›‡ã†": { hiragana: ["ã‚„ã¨ã†"], chinese: "é›‡ç”¨" },
        "ç‹¬ç«‹": { hiragana: ["ã©ãã‚Šã¤"], chinese: "ç¨ç«‹" },
        "å‰åŠ": { hiragana: ["ãœã‚“ã¯ã‚“"], chinese: "å‰åŠæ®µ" },
        "ç™»æ ¡": { hiragana: ["ã¨ã†ã“ã†"], chinese: "ä¸Šå­¸" },
        "è©•åˆ¤": { hiragana: ["ã²ã‚‡ã†ã°ã‚“"], chinese: "åè²" },
        "é­…åŠ›çš„": { hiragana: ["ã¿ã‚Šã‚‡ãã¦ã"], chinese: "æœ‰å¸å¼•åŠ›çš„" },
        "ç§˜è¨£": { hiragana: ["ã²ã‘ã¤"], chinese: "ç§˜è¨£" },
        "å­è‚²ã¦": { hiragana: ["ã“ãã ã¦"], chinese: "é¤Šè‚²å­©å­" },
        "åˆ¥äºº": { hiragana: ["ã¹ã¤ã˜ã‚“"], chinese: "åˆ¥äºº" },
        "è€å¾Œ": { hiragana: ["ã‚ã†ã”"], chinese: "è€å¾Œ" },
        "å‰æ": { hiragana: ["ãœã‚“ã¦ã„"], chinese: "å‰æ" },
        "å¼·ã‚ã‚‹": { hiragana: ["ã¤ã‚ˆã‚ã‚‹"], chinese: "åŠ å¼·" }
        };

    const wordBank = {};
    for (const [kanji, data] of Object.entries(rawWordBank)) {
      wordBank[kanji] = {
        hiragana: Array.isArray(data.hiragana) ? data.hiragana : [data.hiragana],
        chinese: data.chinese
      };
    }

    const questionContainer = document.querySelector(".question-container");
    const feedbackContainer = document.querySelector(".feedback");
    const submitButton = document.getElementById("submit");
    const answerInput = document.getElementById("answer");

    let remainingWords = Object.entries(wordBank);
    let currentWord = null;
    let score = 0;
    let total = remainingWords.length;
    let wrongList = [];

    function getRandomWord() {
      const randomIndex = Math.floor(Math.random() * remainingWords.length);
      return {
        index: randomIndex,
        kanji: remainingWords[randomIndex][0],
        ...remainingWords[randomIndex][1]
      };
    }

    function updateQuestion() {
      if (remainingWords.length === 0) return showResult();
      currentWord = getRandomWord();
      document.querySelector(".question").innerHTML = `${currentWord.kanji}ï¼ˆ${currentWord.chinese}ï¼‰->`;
      answerInput.value = '';
      feedbackContainer.textContent = '';
      submitButton.disabled = true;
      updateProgressBar();
    }

    function updateProgressBar() {
      const progress = total - remainingWords.length;
      document.getElementById("progressBar").style.width = `${(progress / total) * 100}%`;
      document.getElementById("progressText").textContent = `${progress} / ${total}`;
    }

    function showResult() {
      document.querySelector(".question").innerHTML = `ğŸ‰ æ¸¬é©—çµæŸï¼<br>åˆ†æ•¸ï¼š${score} / ${total}`;
      answerInput.disabled = true;
      submitButton.disabled = true;

      let html = "";
      if (wrongList.length > 0) {
        const list = wrongList.map(w =>
          `<li>${w.kanji} â†’ ${w.hiragana.join(" / ")} (${w.chinese})</li>`
        ).join('');
        html += `
          <br><strong>éŒ¯èª¤é¡Œç›®ï¼š</strong>
          <ul style="text-align:left">${list}</ul>
          <button id="retry" class="next-button" style="margin-top: 10px;">å†æŒ‘æˆ°éŒ¯é¡Œ</button>
        `;
      } else {
        html += `<br>ğŸ¯ å®Œç¾ç„¡èª¤ï¼å¤ªå¼·å•¦ï¼`;
      }

      html += `<br><button id="restart" class="next-button" style="margin-top: 10px; background-color:#f44336;">é‡æ–°é–‹å§‹</button>`;
      feedbackContainer.innerHTML = html;

      if (document.getElementById("retry")) {
        document.getElementById("retry").addEventListener("click", () => {
          remainingWords = wrongList.map(w => [w.kanji, { hiragana: w.hiragana, chinese: w.chinese }]);
          wrongList = [];
          score = 0;
          total = remainingWords.length;
          answerInput.disabled = false;
          submitButton.disabled = true;
          updateQuestion();
        });
      }

      document.getElementById("restart").addEventListener("click", () => location.reload());
    }

    function checkAnswer() {
      const userAnswer = answerInput.value.trim();
      if (currentWord.hiragana.includes(userAnswer)) {
        feedbackContainer.textContent = "âœ… æ­£ç¢ºï¼";
        feedbackContainer.style.color = "green";
        remainingWords.splice(currentWord.index, 1);
        score++;
        setTimeout(updateQuestion, 800);
      } else {
        feedbackContainer.innerHTML = `
          âŒ éŒ¯èª¤ï¼Œæ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š<strong>${currentWord.hiragana.join(" / ")}</strong><br>
          <button id="confirm" style="margin-top:10px;" class="next-button">ç¢ºèª</button>
        `;
        feedbackContainer.style.color = "red";
        wrongList.push(currentWord);
        document.getElementById("confirm").addEventListener("click", () => {
          remainingWords.splice(currentWord.index, 1);
          updateQuestion();
        });
      }
    }

    function updateButtonState() {
      submitButton.disabled = !answerInput.value.trim();
    }

    answerInput.addEventListener("input", updateButtonState);
    answerInput.addEventListener("keydown", function (event) {
      if (event.key === "Enter" && !submitButton.disabled) {
        event.preventDefault();
        checkAnswer();
      }
    });

    submitButton.addEventListener("click", checkAnswer);

    updateQuestion();
    updateButtonState();
  </script>
</body>
</html>
